[{"name":"app.R","content":"library(shiny)\r\nlibrary(shinyWidgets)\r\n\r\nfaixa1 <- 2428\r\nfaixa2 <- 2826.65\r\nfaixa3 <- 3751.05\r\nfaixa4 <- 4664.68\r\n\r\naliquota1 <- 0.075\r\naliquota2 <- 0.15\r\naliquota3 <- 0.225\r\naliquota4 <- 0.275\r\n\r\ncalcula_irpf_mensal_antigo <- function(renda) {\r\n  if (renda <= faixa1) {\r\n    0\r\n  } else if (renda <= faixa2) {\r\n    (renda - faixa1) * aliquota1\r\n  } else if (renda <= faixa3) {\r\n    (renda - faixa2) * aliquota2 + (faixa2 - faixa1) * aliquota1\r\n  } else if (renda <= faixa4) {\r\n    (renda - faixa3) * aliquota3 + (faixa3 - faixa2) * aliquota2 + (faixa2 - faixa1) * aliquota1\r\n  } else {\r\n    (renda - faixa4) * aliquota4 +\r\n      (faixa4 - faixa3) * aliquota3 +\r\n      (faixa3 - faixa2) * aliquota2 +\r\n      (faixa2 - faixa1) * aliquota1\r\n  }\r\n}\r\n\r\ncalcula_irpf_mensal_novo <- function(renda, rendimento_tributavel) {\r\n  if (renda <= 5000) {\r\n    0\r\n  } else if (renda <= 7000) {\r\n    reducao <- 1095.11 - 0.156445 * rendimento_tributavel\r\n    max(calcula_irpf_mensal_antigo(renda) - reducao, 0)\r\n  } else {\r\n    calcula_irpf_mensal_antigo(renda)\r\n  }\r\n}\r\n\r\nimposto_final <- function(base_tax, renda) {\r\n  if (is.na(base_tax) || is.na(renda)) {\r\n    return(NA_real_)\r\n  } else if (renda <= 50000) {\r\n    return(base_tax)\r\n  } else if (renda < 100000) {\r\n    desired_tax <- ((((renda * 12 / 60000 - 10)))/100) * renda\r\n    return(max(base_tax, desired_tax))\r\n  } else {\r\n    desired_tax <- (0.10) * renda\r\n    return(max(base_tax, desired_tax))\r\n  }\r\n}\r\n\r\nui <- fluidPage(\r\n  currencyInput(\r\n    inputId = \"rendTotal\",\r\n    label = \"Qual é a sua Renda Total?\",\r\n    value = 1,\r\n    format = \"Brazilian\",\r\n    align = \"center\"\r\n  ),\r\n  currencyInput(\r\n    inputId = \"rendTrib\",\r\n    label = \"Qual é a sua Renda Tributável?\",\r\n    value = 1,\r\n    format = \"Brazilian\",\r\n    align = \"center\"\r\n  ),\r\n  verbatimTextOutput(\"value\")\r\n)\r\nprint.money <- function(x, ...) {\r\n  print.default(paste0(\"$\", formatC(as.numeric(x), format=\"f\", digits=2, big.mark=\",\")))\r\n}\r\n\r\nserver <- function(input, output) {\r\n  rendTrib <- reactive(input$rendTrib)\r\n  rendTotal <- reactive(input$rendTotal)\r\n  \r\n  irpfAntigo <- reactive({\r\n    calcula_irpf_mensal_antigo(rendTrib())\r\n  })\r\n  \r\n  irpfIntermed <- reactive({\r\n    calcula_irpf_mensal_novo(rendTrib(), rendTrib())\r\n  })\r\n  \r\n  irpfNovo <- reactive({\r\n    imposto_final(irpfIntermed(), rendTotal())\r\n  })\r\n  output$value <- renderText({ paste0(\"Atualmente você paga \", sprintf(\"R$%.2f\", irpfAntigo()), \" e vai passar a pagar \", sprintf(\"R$%.2f\", irpfNovo())) })\r\n}\r\n\r\nshinyApp(ui, server)","type":"text"},{"name":"minimum-tax-app/README.md","content":"# Minimum Tax App\nCode for Shiny app","type":"text"}]
